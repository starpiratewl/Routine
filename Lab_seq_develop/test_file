setwd("D:\\wangliang\\project\\lab_seq\\test")

#args= commandArgs(T)
#tracefile=args[1]
tracefile="PCNXL3_SH-1_f"
seqTrace=read.delim(paste(tracefile,"_Trace.txt",sep=""),head=T)
seq <- readLines(paste(tracefile,"_Seq.txt",sep=""))
base <- as.numeric(read.table(paste(tracefile,"_Base.txt",sep="")))
sequence <- substring(seq,1:nchar(seq),1:nchar(seq))

pdf(paste(tracefile,"_SeqPlotAGCT.pdf",sep=""),width=10,height=3)
        r = 1:length(seqTrace[,1])
	plot(x=r, y=seqTrace$T[r],type="l",col="red",xaxt="n",ylab="",ylim=c(0,2000),main=NULL,xlab=paste(tracefile,"_AGCT",sep=""))
	axis(1,seq(0,length(seqTrace[,1]),50))
	lines(x=r,seqTrace$A[r],type="l",col="green")
	lines(x=r,seqTrace$G[r],type="l",col="black")
	lines(x=r,seqTrace$C[r],type="l",col="blue")
#        abline(v=base[base %in% r] + 1, col =5)
        for (i in 1:length(base)){ 
	  if (sequence[i] == "A")
	      colour <- "green"
	  else if (sequence[i] == "T")
	      colour <- "red"
	  else if (sequence[i] == "G")
	      colour <- "black"
	  else if (sequence[i] == "C")
	      colour <- "blue"
	  text(base[i],1700,sequence[i],cex=0.3, col = colour)
	}
dev.off()

pdf(paste(tracefile,"_seqPlotCT.pdf",sep=""),width=10,height=3)
       r = 1:length(seqTrace[,1])
	plot(x=r, y=seqTrace$T[r],type="l",col="red",xaxt="n",ylab="",ylim=c(0,2000),main=NULL,xlab=paste(tracefile,"_AGCT",sep=""))
	axis(1,seq(0,length(seqTrace[,1]),50))
	lines(x=r,seqTrace$C[r],type="l",col="blue")
        #abline(v=base[base %in% r] + 1, col =5)
        for (i in 1:length(base)){ 
	  if (sequence[i] == "A")
	      colour <- "green"
	  else if (sequence[i] == "T")
	      colour <- "red"
	  else if (sequence[i] == "G")
	      colour <- "black"
	  else if (sequence[i] == "C")
	      colour <- "blue"
	  text(base[i],1700,sequence[i],cex=0.3, col = colour)
	}
dev.off()







